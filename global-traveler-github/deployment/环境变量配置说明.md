# 环境变量配置说明

## 必需的环境变量

### GOOGLE_GENERATIVE_AI_API_KEY

**用途**: Google Gemini API 的认证密钥

**获取方式**:
1. 访问 https://makersuite.google.com/app/apikey
2. 登录您的 Google 账号
3. 点击 "Create API Key"
4. 复制生成的 API Key

**配置位置**:

#### 本地开发
在项目根目录创建 `.env.local` 文件：
```bash
GOOGLE_GENERATIVE_AI_API_KEY=your_api_key_here
```

#### Vercel 部署
1. 登录 Vercel Dashboard
2. 进入项目 Settings → Environment Variables
3. 添加变量：
   - Key: `GOOGLE_GENERATIVE_AI_API_KEY`
   - Value: 您的 API Key
   - Environment: 选择所有环境（Production/Preview/Development）

## 兼容的环境变量名称

代码支持以下环境变量名称（按优先级排序）：

1. `GOOGLE_GENERATIVE_AI_API_KEY` ⭐（推荐）
2. `API_KEY`（兼容）
3. `GEMINI_API_KEY`（兼容）

## 安全注意事项

- ✅ API Key 存储在服务器端（Vercel Serverless Functions）
- ✅ 不会暴露给客户端
- ✅ 使用环境变量管理，不硬编码
- ❌ 不要将 API Key 提交到 Git 仓库
- ❌ 不要在前端代码中使用 API Key

## 验证配置

### 本地开发
```bash
# 检查环境变量是否加载
npm run dev
# 访问应用，如果出现 API Key 错误，检查 .env.local 文件
```

### Vercel 部署
1. 部署后查看 Vercel Functions 日志
2. 如果看到 `🔍 检查的环境变量:` 日志，说明代码已运行
3. 确认日志中包含 `GOOGLE_GENERATIVE_AI_API_KEY`

## 故障排除

如果遇到 "API Key 找不到" 错误：

1. **检查环境变量名称**
   - 确保完全匹配：`GOOGLE_GENERATIVE_AI_API_KEY`
   - 区分大小写

2. **检查环境变量值**
   - 无前后空格
   - 无引号
   - 完整复制，无截断

3. **检查环境作用域**
   - Vercel 中必须选择所有环境
   - Production、Preview、Development

4. **重新部署**
   - 添加环境变量后必须重新部署
   - 在 Vercel Dashboard 中手动触发重新部署

5. **查看日志**
   - 检查 Vercel Functions 日志
   - 查看环境变量检查信息

